# Request: 2026-02-19__task-dependency-aware-prioritization-flow

## 前提知識 (Prerequisites / 前提知識) [空欄禁止]

- 参照資料:
  - `AGENTS.md`
  - `docs/INDEX.md`
- 理解ポイント:
  - 本資料に入る前に、目的・受入条件・依存関係を把握する。


## 要望の原文

- タスクの依存関係を示す情報がフレームワークに組み込まれているかを確認したい。
- あるタスクに着手する前に、先に完了すべきタスクがある場合はそちらを優先するようにしたい。
- タスク起票時に依存関係を調査し、必要なら依存先タスクを追加起票できるようにしたい。
- タスク着手時には依存関係を確認し、先行着手すべきタスクがあればそちらを先に進めるフローへ改善したい。
- バックログとタスク表示スキルでも依存関係が分かるようにしたい。
- この要望を要件化してタスク起票し、コミットしてほしい。

## 要望分析

- 直要求:
  - 依存関係管理を起票フローと着手フローに組み込む仕様を定義する。
  - backlog と Rail10 表示に依存関係情報を追加する仕様を定義する。
  - 要件化完了状態で新規 task を起票する。
- 潜在要求:
  - 先行タスク未完了のまま実装が進むことを防止し、手戻りを削減する。
  - planned タスクの着手優先判断を「バックログ順 + 依存解決済み」で一貫化する。
- 非要求:
  - 本リクエスト内で依存関係機能の実装完了までは求めない。
  - 既存完了タスクの全面再設計は求めない。

## 提案オプション（3案）

1. 最小:
   - backlog に手動で依存メモを追加し、運用で確認する。
2. バランス:
   - state.json に依存関係項目を追加し、起票時・着手時に確認するスクリプトを導入する。
   - backlog と Rail10 に依存表示を追加する。
3. 強化（採用）:
   - バランス案に加えて、起票時の依存調査手順、依存先タスク不足時の自動起票方針、依存循環検知、着手ゲートを仕様として統合する。

## 推奨案

- 採用: オプション3（強化）
- 採用理由:
  - ユーザー要望が「起票時」「着手時」「可視化」の3面を同時に求めており、部分対応では目的を満たしにくいため。
  - 依存循環や未起票依存の扱いまで先に定義することで、実装時の判断ぶれを抑えられるため。
- 非採用理由:
  - オプション1は人依存が残り、再発防止が弱い。
  - オプション2は依存不足時の扱いが曖昧で、起票品質が安定しない。

## 分割提案

1. フェーズ1: 依存関係データモデル（state/backlog）を定義する。
2. フェーズ2: 起票時依存調査・不足依存タスク起票フローを定義する。
3. フェーズ3: 着手時依存ゲート、Rail10 表示、検証ルールを定義する。

## 確認質問（2〜4件）

- なし（要望の方向性が具体で、今回の要件化には追加確認不要）。

## request 反映方針

- 「依存関係は未組み込み」という現状を明記したうえで、依存関係管理の標準仕様を task 要件として確定する。

## blocked 判定

- blocked ではない。
